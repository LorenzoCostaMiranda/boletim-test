---
documentclass: report
output:
  pdf_document:
    template: ../template/boletim.tex
    pandoc_args: "--lua-filter=../filter/crossref.lua"
---

```{r include=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
library(scales)
library(zoo)
library(petgg)
library(extrafont)
library(kableExtra)
library(sidrar)
library(lubridate)
library(petknitr)

petknitr::setup()
petgg::set_theme(base_family = "EB Garamond")

m <- 1000
M <- 1000000
B <- 1000000000
```

# Mercado de Trabalho

Os empregos são indicadores para a atividade econômica de um país. Por isso, o governo federal realiza inúmeras pesquisas sobre os empregos formais e informais. O Cadastro Geral de Empregados e Desempregados (CAGED) reúne inúmeras informações sobre os empregos formais, entre admissões, desligamentos, salários, funções, cargos, etc. Também usa-se os dados da Pesquisa Nacional por Amostra de Domicílios PNAD-C para calcular a taxa de desemprego, ocupação, renda média dos trabalhadores.

Diante dos desafios e do cenário incerto por causa da pandemia do COVID-19 em 2020, o mercado de trabalho se transformou, havendo uma elevada taxa de desemprego neste ano. Entretanto, entramos em 2021 com uma melhora dos indicadores do mercado de trabalho. Observa-se que no primeiro trimestre de 2021, o saldo de desemprego manteve-se em terreno positivo, apesar das oscilações. Quando se compara a região norte com o Tocantins, concluímos que esta região teve um saldo mais elevado, mas no geral apresentaram resultados positivos, já em dezembro observa-se um saldo negativo, isso pode se dar pelas expectativas dos agentes econômicos em relação ao ano posterior. Dessa forma, a recomposição da força de trabalho se intensificou devido ao avanço da vacinação combinado à retomada mais forte da atividade econômica. 

Ao analisarmos os gráficos de saldo de emprego por setores, percebe-se que os setores estão desiguais, em relação às contratações e demissões, pois alguns lidaram melhor com os efeitos da COVID-19, como o setor de serviços e indústrias, e outros não conseguiram recuperar os postos de trabalho perdidos, apesar de ter ficado com um saldo positivo, como o setor de construção, agricultura e comércio. A economia tocantinense tem um perfil voltado para os serviços, comércio e agricultura, de acordo com a Figura [fig:@saldo_setor_to], mas o setor que se sobressaiu foi o de serviços, ficando próximo do de indústria. 


```{r saldo, fig.cap= "Saldo de empregos ao longo de 2021", fig.subcap="Em Mil", fig.source = "\\acrshort{caged}", wrap = "open"}
# Saldo de Empregos Norte e Tocantins
tibble(
  `Região Norte` = c(8250, 13624, 9438, 9584, 18179, 24405, 24075, 22578, 17664, 9223, 17202, -14418),
  Tocantins = c(1572, 2531, 1062, 1179, 1719, 1921, 1653, 1597, 1791, 1757, 1247, -1667),
  mes = c("jan", "fev", "mar", "abr", "mai", "jun", "jul", "ago", "set", "out", "nov", "dez")
) %>%
  pivot_longer(!mes, names_to = "local", values_to = "saldo") %>%
  ggplot(aes(factor(mes, levels = c("jan", "fev", "mar", "abr", "mai", "jun", "jul", "ago", "set", "out", "nov", "dez")), saldo, fill = local)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = function(n) n / m)
```

```{r saldo_setor_to, fig.cap = "Saldo por setores em 2021", fig.subcap="Em Mil", fig.source = "\\acrshort{caged}"}
# Saldo por Setores no Tocantins
tibble(
  Saldo = c(1473, 5890, 613, 2062, 6324),
  Setores = c("Agricultura", "Indústrias", "Construção", "Comércio", "Serviços")
) %>%
  ggplot(aes(Setores, Saldo)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = function(n) n / m)
```

```{r pedido_segudo_desem, fig.cap= "Pedidos de seguro desemprego em 2021", fig.subcap="Em Mil", fig.source = "\\acrshort{ibge}", wrap = "close"}
# Pedidos Seguro desemprego mensal
tibble(
  value = c(9432, 9366, 11172, 10004, 9449, 9366, 9196, 9269, 8227, 8129, 8897, 8782),
  mes = seq(as.Date("2021-01-01"), as.Date("2021-12-01"), by = "month")
) %>%
  ggplot(aes(mes, value)) +
  geom_line() +
  scale_y_continuous(labels = function(x) x / m) +
  scale_x_date(
    labels = date_format("%b\n%Y"), date_breaks = "1 month"
  )
```

Um termômetro claro para o setor de empregos são os pedidos seguro- desemprego, uma política macroeconômica para gerar uma segurança branda para o trabalhador recém demitido. Num contexto mais claro, significa que se ocorre uma elevação dos pedidos de seguro desemprego, expressa que o mercado de trabalho não está em um bom funcionamento. O inverso é claro também, se a poucos pedidos é uma reação a um bom momento econômico. O que pode ser observado é o movimento similar da taxa de desemprego e os pedidos-seguro desemprego, quando os pedidos sofrem uma redução a partir de abril de 2021, e apresentando uma oscilação mínima de agosto, mas posteriormente permaneceu em queda, em termos mais gerais. No primeiro trimestre de 2021 é notado o alto movimento de solicitações desse benefício, o que condiz com a alta taxa de desemprego e o momento de crise econômica provocada pela COVID-19, neste momento os agentes ainda estavam retomando ao mercado, com uma certa insegurança. Fazendo uma comparação com a taxa de desemprego, é apresentada a noção de que a taxa se reduz e gera uma redução nos pedidos de seguro desemprego, uma demonstração clara de como a taxa é crucial para a avaliação macroeconômica. É realizado uma regressão na Figura [fig:@reg_emprego] para definir o quão importante é a taxa de desemprego em relação ao seguro desemprego, para o mercado de trabalho.

O mercado de trabalho brasileiro vem apresentando trajetória de forte dinamismo, marcada por expressiva expansão da população ocupada, com efeito significativo sobre a redução do desemprego. O  crescimento da ocupação, entretanto, vem ocorrendo de modo mais intenso nos setores informais, refletindo, especialmente, retomada dos serviços mais beneficiados com o relaxamento das medidas de restrição social, e com a vacinação em massa, apresentado na figura [fig:@pop_ocupada] um salto do segundo trimestre de 2021 para o terceiro trimestre de 2021, saindo de 51% para um patamar de aproximadamente 54,7%

A Figura [fig:@rendimentos] apresenta o rendimento médio mensal a partir da média das remunerações dos trabalhadores extraída da população ocupada por meio de trabalho principal. A renda média nominal tocantinense do terceiro trimestre de 2021 foi mais elevada quando comparada ao Brasil e à Região Norte. No entanto, em termos gerais, é observável pelo gráfico que a renda média do Brasil é superior à da região norte e do estado do Tocantins, o que pode ser atribuído por englobar regiões maiores em desenvolvimento produtivo, como o sul e sudeste. No entanto, em termos nominais a renda média estadual obtém uma vantagem em relação à região norte se comparada a nacional.

```{r reg_emprego, fig.cap= "Relação seguro desemprego x taxa de desemprego", fig.subcap="Em 2021", fig.source = "\\acrshort{mte}", wrap = TRUE}
reg_data <- tibble(
  taxa_desemprego = c(11, 11.3, 9.8, 10.4, 12.3, 11.4, 10.5, 9.1, 11.2, 12.5, 12.2, 11.6),
  pedidos_seguro_desemprego = c(9432, 9366, 11172, 10004, 9449, 9366, 9196, 9269, 8227, 8129, 8897, 8782)
)

ggplot(reg_data, aes(x = taxa_desemprego, y = pedidos_seguro_desemprego)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) +
  labs(x = "Taxa de desemprego", y = "Seguro Desemprego") +
  theme_petgg(axis_title = T, base_family = "EB Garamond")
```



```{r taxa_desemprego, fig.cap= "Taxa de desemprego no Tocantins", fig.subcap="Variaçao trimestral", fig.source = "\\acrshort{ibge}", wrap = "open"}
df <- get_sidra(
  x = 4092,
  geo = "State",
  header = T,
  period = "202101-202104"
) %>% janitor::clean_names()

df %>%
  filter(
    unidade_da_federacao == "Tocantins",
    condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao %in% c(
      "Força de trabalho - desocupada",
      "Força de trabalho"
    ),
    unidade_de_medida == "Mil pessoas"
  ) %>%
  select(trimestre_codigo, condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao, valor) %>%
  pivot_wider(
    names_from = condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao,
    values_from = valor
  ) %>%
  rowwise() %>%
  mutate(
    taxa_des = `Força de trabalho - desocupada` / `Força de trabalho` * 100,
    quarter = trimestre_codigo %>% stringr::str_replace("(?<=\\d{4})\\d", "Q"),
    tri = zoo::as.yearqtr(quarter) %>% as.Date()
  ) %>%
  ggplot(aes(tri, taxa_des)) +
  geom_line() +
  scale_x_date(
    breaks = scales::breaks_width("3 month", offset = -59),
    labels = function(x) zoo::format.yearqtr(x, "%qT\n%Y")
  )
```

```{r pop_ocupada, fig.cap= "População ocupada no Tocantins", fig.subcap="Variaçao trimestral", fig.source = "\\acrshort{ibge}"}
sidrar::get_sidra(
  x = 4092,
  header = T,
  geo = "State",
  period = "202101-202104"
) %>%
  janitor::clean_names() %>%
  filter(
    unidade_da_federacao == "Tocantins",
    condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao %in% c(
      "Força de trabalho - ocupada",
      "Total"
    ),
    unidade_de_medida == "Mil pessoas"
  ) %>%
  select(trimestre_codigo, condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao, valor) %>%
  pivot_wider(
    names_from = condicao_em_relacao_a_forca_de_trabalho_e_condicao_de_ocupacao,
    values_from = valor
  ) %>%
  rowwise() %>%
  mutate(
    pop_ocu = `Força de trabalho - ocupada` / `Total` * 100,
    quarter = trimestre_codigo %>% stringr::str_replace("(?<=\\d{4})\\d", "Q"),
    tri = zoo::as.yearqtr(quarter) %>% as.Date()
  ) %>%
  ggplot(aes(tri, pop_ocu)) +
  geom_line() +
  scale_x_date(
    breaks = scales::breaks_width("3 month", offset = -59),
    labels = function(x) zoo::format.yearqtr(x, "%qT\n%Y")
  )
```



```{r rendimentos, fig.cap= "Rendimento médio mensal", fig.subcap="Em mil R$", fig.source = "\\acrshort{ibge}", wrap = "close"}
# Rendimentos - Tocantins
rendi <- get_sidra(
  x = 5439,
  geo = "State",
  header = T,
  period = "202101-202104"
) %>% janitor::clean_names()

rendimento_to <- rendi %>%
  filter(unidade_da_federacao == "Tocantins", posicao_na_ocupacao_no_trabalho_principal == "Total", unidade_de_medida == "Reais", variavel == "Rendimento médio real do trabalho principal, efetivamente recebido no mês de referência, pelas pessoas de 14 anos ou mais de idade, ocupadas na semana de referência, com rendimento de trabalho") %>%
  mutate(
    quarter = trimestre_codigo %>% stringr::str_replace("(?<=\\d{4})\\d", "Q"),
    tri = zoo::as.yearqtr(quarter) %>% as.Date()
  )

# Rendimentos - Brasil
rendi_br <- get_sidra(
  x = 5439,
  header = T,
  period = "202101-202104"
) %>% janitor::clean_names()

rendimento_brasil <- rendi_br %>%
  filter(nivel_territorial == "Brasil", posicao_na_ocupacao_no_trabalho_principal == "Total", unidade_de_medida == "Reais", variavel == "Rendimento médio real do trabalho principal, efetivamente recebido no mês de referência, pelas pessoas de 14 anos ou mais de idade, ocupadas na semana de referência, com rendimento de trabalho") %>%
  mutate(
    quarter = trimestre_codigo %>% stringr::str_replace("(?<=\\d{4})\\d", "Q"),
    tri = zoo::as.yearqtr(quarter) %>% as.Date()
  )

# Rendimento - Norte
rendi_norte <- get_sidra(
  x = 5439,
  header = T,
  geo = "Region",
  period = "202101-202104"
) %>% janitor::clean_names()

rendimento_norte <- rendi_norte %>%
  filter(grande_regiao == "Norte", unidade_de_medida == "Reais", posicao_na_ocupacao_no_trabalho_principal == "Total", variavel == "Rendimento médio real do trabalho principal, efetivamente recebido no mês de referência, pelas pessoas de 14 anos ou mais de idade, ocupadas na semana de referência, com rendimento de trabalho") %>%
  mutate(
    quarter = trimestre_codigo %>% stringr::str_replace("(?<=\\d{4})\\d", "Q"),
    tri = zoo::as.yearqtr(quarter) %>% as.Date()
  )

ggplot() +
  geom_line(rendimento_to, mapping = aes(tri, valor, colour = "Tocantins")) +
  geom_line(rendimento_brasil, mapping = aes(tri, valor, colour = "Brasil")) +
  geom_line(rendimento_norte, mapping = aes(tri, valor, colour = "Região Norte")) +
  scale_color_manual(values = petgg::colors[1:3]) +
  scale_x_date(
    breaks = scales::breaks_width("3 month", offset = -59),
    labels = function(x) zoo::format.yearqtr(x, "%qT\n%Y"),
    limits = c(as.Date("2021-01-01"), as.Date("2021-11-01"))
  )
```